# Khu Phaen (‡∏Ç‡∏∏‡∏ô‡πÅ‡∏ú‡∏ô)

Offline Task Management System - ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö Offline ‡∏ó‡∏µ‡πà‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏û‡∏∂‡πà‡∏á internet ‡∏Å‡πá‡πÉ‡∏ä‡πâ‡πÑ‡∏î‡πâ

> **Khu Phaen** (‡∏Ç‡∏∏‡∏ô‡πÅ‡∏ú‡∏ô) - ‡∏ï‡∏±‡πâ‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ï‡∏≤‡∏°‡∏ß‡∏£‡∏£‡∏ì‡∏Ñ‡∏î‡∏µ‡πÑ‡∏ó‡∏¢ ‡∏´‡∏°‡∏≤‡∏¢‡∏ñ‡∏∂‡∏á‡∏ú‡∏π‡πâ‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡πÄ‡∏ä‡∏µ‡πà‡∏¢‡∏ß‡∏ä‡∏≤‡∏ç ‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÑ‡∏î‡πâ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡∏†‡∏≤‡∏û

## ‚ú® Features

- ‚úÖ **Task Management** - ‡πÄ‡∏û‡∏¥‡πà‡∏° ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç ‡∏•‡∏ö‡∏á‡∏≤‡∏ô
- üë• **Team Management** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏°‡∏≤‡∏ä‡∏¥‡∏Å‡∏ó‡∏µ‡∏°‡πÅ‡∏•‡∏∞‡∏°‡∏≠‡∏ö‡∏´‡∏°‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
- üìÅ **Project Management** - ‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏°‡∏á‡∏≤‡∏ô‡∏ï‡∏≤‡∏°‡πÇ‡∏õ‡∏£‡πÄ‡∏à‡∏Ñ
- üìÖ **Calendar View** - ‡∏î‡∏π‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏£‡∏π‡∏õ‡πÅ‡∏ö‡∏ö‡∏õ‡∏è‡∏¥‡∏ó‡∏¥‡∏ô
- üéØ **Kanban Board** - ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö‡∏•‡∏≤‡∏Å-‡∏ß‡∏≤‡∏á (Drag & Drop)
- üìä **Task Statistics** - ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÅ‡∏•‡∏∞‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô
- üì§ **Export/Import** - ‡∏™‡πà‡∏á‡∏≠‡∏≠‡∏Å/‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ CSV ‡πÅ‡∏•‡∏∞ PDF
- üíæ **Local Storage** - ‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô browser (IndexedDB)
- üåô **Dark Mode** - ‡πÇ‡∏´‡∏°‡∏î‡∏Å‡∏•‡∏≤‡∏á‡∏Ñ‡∏∑‡∏ô
- üîÑ **Real-time Sync** - ‡∏ã‡∏¥‡∏á‡∏Ñ‡πå‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• real-time ‡∏ú‡πà‡∏≤‡∏ô WebSocket (‡∏ï‡πâ‡∏≠‡∏á‡∏£‡∏±‡∏ô Sync Server)

## üèóÔ∏è Project Structure

```
.
‚îú‚îÄ‚îÄ src/                    # SvelteKit Frontend
‚îú‚îÄ‚îÄ sync-server/            # Rust WebSocket Sync Server
‚îú‚îÄ‚îÄ wasm-compress/          # WASM: LZ4 Compression
‚îú‚îÄ‚îÄ wasm-crdt/              # WASM: CRDT for collaborative editing
‚îú‚îÄ‚îÄ wasm-search/            # WASM: Full-text search
‚îú‚îÄ‚îÄ static/                 # Static assets
‚îî‚îÄ‚îÄ build/                  # Build output (static files)
```

## üöÄ Getting Started

### Prerequisites

- [Node.js](https://nodejs.org/) 18+ 
- [Rust](https://rustup.rs/) (‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ build sync-server ‡∏´‡∏£‡∏∑‡∏≠ WASM)

### 1. Install Dependencies

```sh
npm install
```

### 2. Run Development Server

```sh
# Run frontend dev server
npm run dev

# ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏õ‡∏¥‡∏î browser ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
npm run dev -- --open
```

Frontend ‡∏à‡∏∞‡∏£‡∏±‡∏ô‡∏ó‡∏µ‡πà `http://localhost:5173`

### 3. Run Sync Server (Optional - ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö Real-time Sync)

‡πÉ‡∏ô terminal ‡∏≠‡∏µ‡∏Å‡∏≠‡∏±‡∏ô:

```sh
cd sync-server
cargo run --release
```

Sync Server ‡∏à‡∏∞‡∏£‡∏±‡∏ô‡∏ó‡∏µ‡πà `http://localhost:3001`

### 4. Build WASM Modules (Optional)

‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£ build WASM ‡πÄ‡∏≠‡∏á:

```sh
# Build wasm-compress
cd wasm-compress
cargo build --release --target wasm32-unknown-unknown

# Build wasm-crdt
cd ../wasm-crdt
cargo build --release --target wasm32-unknown-unknown

# Build wasm-search
cd ../wasm-search
cargo build --release --target wasm32-unknown-unknown
```

## üè≠ Build for Production

### Build Frontend

```sh
npm run build
```

‡πÑ‡∏ü‡∏•‡πå static ‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÇ‡∏ü‡∏•‡πÄ‡∏î‡∏≠‡∏£‡πå `build/`

### Build Sync Server Binary

```sh
cd sync-server
cargo build --release
# Binary ‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà target/release/sync-server
```

## üê≥ Docker / Podman Deployment (Sync Server Only)

> **Frontend** ‡πÉ‡∏ä‡πâ Static Files ‡∏à‡∏≤‡∏Å `npm run build` ‡πÅ‡∏•‡πâ‡∏ß‡∏ô‡∏≥‡πÑ‡∏õ host ‡∏ö‡∏ô nginx/apache ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢
> 
> **Sync Server** ‡∏£‡∏±‡∏ô‡∏ú‡πà‡∏≤‡∏ô Docker ‡∏´‡∏£‡∏∑‡∏≠ Podman ‡∏ï‡∏≤‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á

### Option 1: ‡πÉ‡∏ä‡πâ Pre-built Image ‡∏à‡∏≤‡∏Å GHCR (‡πÅ‡∏ô‡∏∞‡∏ô‡∏≥)

```sh
podman run -d \
  --name khu-phaen-sync \
  --memory=100m \
  -p 3002:3001 \
  ghcr.io/watchakorn-18k/khun-phaen-tracker-offline/sync-server:latest
```

‡∏´‡∏£‡∏∑‡∏≠‡πÉ‡∏ä‡πâ Docker:

```sh
docker run -d \
  --name khu-phaen-sync \
  --memory=100m \
  -p 3002:3001 \
  ghcr.io/watchakorn-18k/khun-phaen-tracker-offline/sync-server:latest
```

‡∏´‡∏•‡∏±‡∏á‡∏£‡∏±‡∏ô‡πÄ‡∏™‡∏£‡πá‡∏à‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà:

- REST API: `http://localhost:3002`
- WebSocket: `ws://localhost:3002/ws`

### Option 2: Docker Compose

```yaml
version: '3.8'

services:
  khu-phaen-sync:
    image: ghcr.io/watchakorn-18k/khun-phaen-tracker-offline/sync-server:latest
    ports:
      - "3002:3001"
    environment:
      - PORT=3001
      - RUST_LOG=info
    restart: unless-stopped
```

‡∏£‡∏±‡∏ô‡∏î‡πâ‡∏ß‡∏¢:

```sh
docker-compose up -d
```

### Option 3: Build Image ‡πÄ‡∏≠‡∏á

```sh
cd sync-server

# Build image
docker build -t khu-phaen-sync .

# Run (host 3002 -> container 3001)
docker run -d \
  --name khu-phaen-sync \
  --memory=100m \
  -p 3002:3001 \
  khu-phaen-sync
```

## üåê Render (HTTPS / WSS)

‡∏ñ‡πâ‡∏≤‡∏à‡∏∞ deploy ‡∏ö‡∏ô Render ‡πÉ‡∏´‡πâ‡πÉ‡∏ä‡πâ URL ‡πÅ‡∏ö‡∏ö `https` ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô ‡πÄ‡∏ä‡πà‡∏ô:

```txt
https://khu-phaen-sync.onrender.com
```

‡∏ß‡∏¥‡∏ò‡∏µ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô:

1. ‡∏™‡∏£‡πâ‡∏≤‡∏á Render Web Service ‡∏à‡∏≤‡∏Å image `ghcr.io/watchakorn-18k/khun-phaen-tracker-offline/sync-server:latest`
2. ‡πÉ‡∏´‡πâ service bind ‡∏Å‡∏±‡∏ö `PORT` (Render ‡∏à‡∏∞ inject ‡∏Ñ‡πà‡∏≤‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥)
3. ‡πÉ‡∏ô‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏≠‡∏õ ‡πÉ‡∏™‡πà Server URL ‡πÄ‡∏õ‡πá‡∏ô `https://<your-service>.onrender.com`
4. ‡∏ï‡∏±‡∏ß‡πÅ‡∏≠‡∏õ‡∏à‡∏∞‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÄ‡∏õ‡πá‡∏ô `wss://<your-service>.onrender.com/ws` ‡πÉ‡∏´‡πâ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠ WebSocket

## ‚öôÔ∏è Configuration

### Environment Variables

#### Frontend (Build Time)

| Variable | Default | Description |
|----------|---------|-------------|
| `PUBLIC_SYNC_SERVER_URL` | `http://localhost:3001` | Base URL ‡∏Ç‡∏≠‡∏á Sync Server (`http://` ‡∏´‡∏£‡∏∑‡∏≠ `https://`) |

#### Sync Server (Runtime)

| Variable | Default | Description |
|----------|---------|-------------|
| `PORT` | `3001` | Port ‡∏ó‡∏µ‡πà server ‡∏à‡∏∞‡∏£‡∏±‡∏ô |
| `RUST_LOG` | `info` | Log level (error, warn, info, debug, trace) |

## üì° Sync Server API

### REST Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| GET | `/` | Server info |
| GET | `/health` | Health check |
| POST | `/api/rooms` | ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏´‡πâ‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà |
| GET | `/api/rooms/:room_code` | ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏´‡πâ‡∏≠‡∏á |

### WebSocket Endpoint

```
WS /ws
```

‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà [sync-server/README.md](sync-server/README.md)

## üìÅ Project Details

### Tech Stack

- **Frontend**: SvelteKit 5 + TypeScript + Tailwind CSS 4
- **State Management**: Svelte Stores
- **Database**: IndexedDB (via idb library)
- **Sync Server**: Rust + Axum + WebSocket
- **WASM**: Rust (compression, CRDT, search)
- **Calendar**: FullCalendar
- **PDF Export**: jsPDF
- **Icons**: Lucide Svelte

### Build Targets

- **Frontend**: Static files (adapter-static)
- **Base Path**: `/khun-phaen-tracker-offline` (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö GitHub Pages)

## üìÑ License

MIT

---

<p align="center">
  ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏î‡πâ‡∏ß‡∏¢ ‚ù§Ô∏è ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏≤‡∏ô‡πÅ‡∏ö‡∏ö Offline-First
</p>
